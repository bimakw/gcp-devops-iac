# Copyright (c) 2024 Bima Kharisma Wicaksana
# Kubecost GCP Integration Secret Template
# NOTE: This is a template. Replace with actual values or use External Secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: kubecost-gcp-integration
  namespace: cost-monitoring
  labels:
    app.kubernetes.io/name: kubecost
    app.kubernetes.io/component: integration
type: Opaque
stringData:
  # GCP Cloud Integration configuration
  cloud-integration.json: |
    {
      "gcp": {
        "bigQuery": {
          "projectId": "${PROJECT_ID}",
          "dataset": "billing_export",
          "table": "gcp_billing_export_v1_*"
        }
      }
    }
---
# ExternalSecret version (recommended for production)
# Uncomment and use this if External Secrets Operator is installed
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: kubecost-gcp-integration
#   namespace: cost-monitoring
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     name: gcp-secret-store
#     kind: ClusterSecretStore
#   target:
#     name: kubecost-gcp-integration
#     creationPolicy: Owner
#   data:
#     - secretKey: cloud-integration.json
#       remoteRef:
#         key: kubecost-gcp-config
---
apiVersion: v1
kind: Secret
metadata:
  name: kubecost-gcp-bucket
  namespace: cost-monitoring
  labels:
    app.kubernetes.io/name: kubecost
    app.kubernetes.io/component: storage
type: Opaque
stringData:
  # ETL bucket configuration
  bucket.json: |
    {
      "type": "GCS",
      "config": {
        "bucket": "${PROJECT_ID}-kubecost-etl",
        "region": "${REGION}"
      }
    }
